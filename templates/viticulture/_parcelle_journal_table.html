<table class="table table-sm table-hover align-middle">
  <thead>
    <tr><th>Date</th><th>Type</th><th>RÃ©sumÃ©</th><th>Surface</th><th>CoÃ»ts</th><th style="width: 80px;"></th></tr>
  </thead>
  <tbody>
  {% for it in items %}
    <tr class="cursor-pointer" onclick="window.location='/viticulture/journal/{{ it.id }}/'">
      <td>{{ it.date }}{% if it.date_end %} â†’ {{ it.date_end }}{% endif %}</td>
      <td>
        <span class="badge 
          {% if it.op_type.code == 'taille' %}bg-success
          {% elif it.op_type.code == 'traitement' %}bg-warning text-dark
          {% elif it.op_type.code == 'palissage' %}bg-info
          {% elif it.op_type.code == 'travail_sol' %}bg-secondary
          {% elif it.op_type.code == 'effeuillage' %}bg-success
          {% elif it.op_type.code == 'fertilisation' %}bg-dark
          {% elif it.op_type.code == 'irrigation' %}bg-info
          {% else %}bg-light text-dark border{% endif %}">
          {{ it.op_type.label }}
        </span>
      </td>
      <td>
        <div>{{ it.resume }}</div>
        {% if it.notes %}<div class="text-muted small">{{ it.notes|truncatechars:120 }}</div>{% endif %}
        {% if it.attachments %}
          <div class="small mt-1">
            {% for f in it.attachments %}
              <a href="{{ f.url }}" target="_blank" class="me-2" onclick="event.stopPropagation();">ðŸ“Ž {{ f.name }}</a>
            {% endfor %}
          </div>
        {% endif %}
      </td>
      <td>{% if it.surface_ha %}{{ it.surface_ha }} ha{% else %}â€”{% endif %}{% if it.rangs %}<div class="small text-muted">Rangs: {{ it.rangs }}</div>{% endif %}</td>
      <td>
        {% if it.cout_total_eur %}â‚¬ {{ it.cout_total_eur }}{% else %}â€”{% endif %}
        {% if it.cout_mo_eur or it.cout_matiere_eur %}
          <div class="small text-muted">
            {% if it.cout_mo_eur %}MO: â‚¬ {{ it.cout_mo_eur }}{% endif %}
            {% if it.cout_matiere_eur %} â€¢ MS: â‚¬ {{ it.cout_matiere_eur }}{% endif %}
          </div>
        {% endif %}
      </td>
      <td class="text-center">
        <i class="bi bi-pencil-square text-primary" title="Voir / Modifier"></i>
      </td>
    </tr>
  {% empty %}
    <tr><td colspan="6" class="text-muted text-center py-4">Aucune opÃ©ration pour ces filtres.</td></tr>
  {% endfor %}
  </tbody>
</table>
<style>.cursor-pointer { cursor: pointer; } .cursor-pointer:hover { background-color: #f8f9fa; }</style>
